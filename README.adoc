= File Creation over the Github API
:author: Urs Roesch
:author:    Urs Roesch
:firstname: Urs
:lastname:  Roesch
:email:     github@bun.ch
:revnumber: 0.7.1
:keywords:  PowerShell, CLI, Github, Gitlab
:!toc:
:icons: font
:git-user: uroesch
:repo-name: pdftools
ifdef::env-gitlab[]
:base-url:   https://gitlab.com/{git-user}/{repo-name}
:email:      gitlab@bun.ch
endif::env-gitlab[]
ifdef::env-github[]
:base-url:          https://github.com/{git-user}/{repo-name}
:email:             github@bun.ch
:tip-caption:       :bulb:
:note-caption:      :information_source:
:important-caption: :heavy_exclamation_mark:
:caution-caption:   :fire:
:warning-caption:   :warning:
endif::env-github[]


== Powershell

=== Installation

[source,console]
----
> Install-Module -Name PowerShellForGitHub
----

=== Set authentication credentials

[source,console]
----
> $secret   = ( `
    sops exec-env secrets.yaml 'echo $SANDBOX_TOKEN' | `
    ConvertTo-SecureString -AsPlainText -Force `
  )
> $credentials = New-Object System.Management.Automation.PSCredential `
    "username is ignored", `
    $secret
> Set-GitHubAuthentication -Credential $credentials
----

=== Create a commit

To create push a commit of a file called `bar.txt` into the directory `foo` in
branch `main` use the following PowerShell command.

[source,console]
----
> Set-GitHubContent `
  -OwnerName $Owner `
  -RepositoryName $RepoName `
  -Path foo/bar.txt `
  -CommitMessage 'Adding foobar.txt' `
  -Content 'This is a text message' `
  -BranchName main
----

// vim: set colorcolumn=80 textwidth=80 spell spelllang=en_us :
